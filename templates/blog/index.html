{% extends "blog/base.html" %}
{% block css_links %}
{% load static %}
<link rel="stylesheet" href="{% static "blog/css/blog-main.css" %}">
{% endblock css_links %}
{% block content %}

<h1 class="page-header">
    Posts
    {% comment %} <small>Secondary Text</small> {% endcomment %}
</h1> 

<!-- First Blog Post -->
{% for post in page_obj.object_list %}
<h2>
    <a href="{% url "post" id=post.pk %}">{{ post.title }}</a>
</h2>
<p class="lead">
    {% if post.user %}
    by 
    <a href="{% url "user_profile" post.user.user.username %}">
        {{post.user.user.username}}
    </a>
    {% endif %} 
    {% comment %} {% elif request.user == post.user.user %} 
        by 
        <a href="{% url "profile" %}">
            {{user.username}}
        </a>
    {% else %}
        by 
        <a href="#">
            {{ user.username }}
        </a>
    {% endif %} {% endcomment %}
    {% comment %} {% else %}
    by 
    <a href="#">
    {{post.user.username}}
    </a>
    {% endif %} {% endcomment %}
</p>
<p><span class="glyphicon glyphicon-time"></span> Posted on {{post.publish_date}}</p>
<hr>
{% if post.image %}
    <img class="img-responsive" src="{{ post.image.url }}" alt="{{ post.title }}">
{% endif %}
<hr>
<p>{{ post.content | truncatewords:20 }}</p>
<div class="tags">
    <div style='display:flex; align-items: self-end; justify-content: center; gap:.2em'>
        <button style="background: none; border: none;" name="post_id" value="{{ post.id }}">
        {% if user in post.likes.all %}
            <a href="{% url "post" id=post.pk %}">
                <i class="bi bi-suit-heart-fill" style="font-size: 40px; color: #b22222"></i>
            </a>
        {% else %}
            <a href="{% url "post" id=post.pk %}">
                <i class="bi bi-suit-heart" style="font-size: 40px; color: gray"></i>
            </a>
        {% endif %}
        </button>
        <p style='font-size: 27px'>{{post.likes.count}}</p>
    </div>
</div>
<div class="tags">
    <p>Tags</p>
    <div class="tags-content">
        {% for tag in post.tags.all %}
        <p><a href="{% url 'tag' tag.name %}">{{tag.name}}</a></p>
        {% endfor %}
    </div>  
</div>
<a class="btn btn-primary" href="{% url "post" id=post.pk %}">Read More <span class="glyphicon glyphicon-chevron-right"></span></a>

<hr>
{% endfor %}


<!-- Pager -->
<ul class="pager">
    {% if page_obj.has_previous %}
        <li class="previous">
            <a href="?page={{ page_obj.previous_page_number }}">&larr; Older</a>
        </li>
    {% else %}
        <li class="previous disabled">
            <a href="#">&larr; Older</a>
        </li>
    {% endif %}
    {% if page_obj.has_next %}
        <li class="next">
            <a href="?page={{ page_obj.next_page_number }}">Newer &rarr;</a>
        </li>
    {% else %}
        <li class="next disabled">
            <a href="#">Newer &rarr;</a>
        </li>
    {% endif %}
</ul>

{% endblock content %}